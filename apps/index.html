<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>cr0w | IGPreferences</title>

  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="bootstrap/css/font-awesome.css">
  <link rel = "stylesheet" href="style.css">
  <link rel = "stylesheet" href="sliding.css">

  <script src="js/jquery-3.2.1.js"></script>
  <script type="text/javascript" src="js/js.cookie.js"></script>
  <script type="text/javascript">
    $(function () {

      $.post("index.php",{ApiName: "AuthCookie", Page: "igpreferences"},onAjaxSuccessed);
      $('#slideBlock').attr('style','margin-top:10px;');
    //$('#pan1').attr('style','display:none;');
    //$('#pan2').attr('style','display:none;');
    //$('#showHideContent').attr('style','border-radius: 5px 5px 5px 5px;background-color:#5b8bde;margin-top:10px;');
  });


    function onAjaxSuccessed(data) {
      if (data=="OK") {
        $('#lPButton').remove();
        $('#registerButton').remove();
        $('#enterButton').remove();
        var cookie = $.cookie("Cr0WArea");
        var login = cookie.split(":")[0];
        $('#cabinetButt').html('<span class="glyphicon glyphicon-briefcase"></span> Личный кабинет ('+login+')');
      }
      else {
        $('#exitButton').remove();
        $('#myCabButton').remove();
      }
    }
  </script>
  <link rel="shortcut icon" type="image/x-icon" href="https://cr0w.pw/images/favicon.ico"/>
</head>
<body>
  <!-- Modal registration -->
  <div class="modal fade" id="reg_Modal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header" style="padding:0px 0px;background-color:#f2f2f2;text-align:center">
          <button type="button" class="close" data-dismiss="modal">x</button>
          <h4>Регистрация</h4>
        </div>
        <div class="modal-body" style="padding:0px 0px;">
          <form role="form" action="/php/register.php" method="post">
            <div class="form-group">
              <label for="usrname" style="margin-left:25px;"><span class="glyphicon glyphicon-user"></span> Логин</label>
              <input type="text" class="form-control" id="reg_Login" placeholder="Введите логин">
            </div>
            <div class="form-group" style="margin-top:-10px;">
              <label for="email" style="margin-left:25px;"><span class="glyphicon glyphicon-envelope"></span> Email</label>
              <input type="email" class="form-control" id="reg_Email" placeholder="Введите email">
            </div>
            <div class="form-group" style="margin-top:-10px;">
              <label for="psw1" style="margin-left:25px;"><span class="glyphicon glyphicon-eye-open"></span> Пароль</label>
              <input type="password" class="form-control" id="reg_Password" placeholder="Ввведите пароль">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button reset" class="btn btn-danger width-100" style="float:left;" data-dismiss="modal">
            <span class="glyphicon glyphicon-remove"></span> Отмена</button>
            <button type="submit" id="regButt" class="btn btn-success width-200" style="float:right;">
              <span class="glyphicon glyphicon-off"></span> Зарегистрироваться</button>
            </div>
          </div>

        </div>
      </div>
      <!-- Modal login -->
      <div class="modal fade" id="log_Modal" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header" style="padding:0px 0px;background-color:#f2f2f2;text-align:center">
              <button type="button" class="close" data-dismiss="modal">x</button>
              <h4><span class="glyphicon glyphicon-log-in"></span> Авторизация</h4>
            </div>
            <div class="modal-body" style="padding:0px 0px;">
              <form role="form" action="javascript:void(0);" method="post">
                <div class="form-group">
                  <label for="usrname" style="margin-left:25px;"><span class="glyphicon glyphicon-user"></span> Логин</label>
                  <input type="text" class="form-control" id="authlogin" placeholder="Логин">
                </div>
                <div class="form-group" style="margin-top:-10px;">
                  <label for="psw1" style="margin-left:25px;"><span class="glyphicon glyphicon-eye-open"></span> Пароль</label>
                  <input type="password" class="form-control" id="authpass" placeholder="Пароль">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button reset" class="btn btn-danger width-100" style="float:left;" data-dismiss="modal">
                <span class="glyphicon glyphicon-remove"></span> Отмена</button>
                <button type="submit" id="loginBtn" class="btn btn-success width-200" style="float:right;">
                  <span class="glyphicon glyphicon-off"></span> Вход</button>
                </div>
              </div>

            </div>
          </div>
          <!-- Modal lost password -->
          <div class="modal fade" id="lPass_Modal" role="dialog">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header" style="padding:0px 0px;background-color:#f2f2f2;text-align:center">
                  <button type="button" class="close" data-dismiss="modal">x</button>
                  <h4><span class="glyphicon glyphicon-lock"></span> Забыли пароль?</h4>
                </div>
                <div class="modal-body" style="padding:0px 0px;">
                  <form role="form" action="javascript:void(0);" method="post">
                   <div class="form-group">
                    <label for="email" style="margin-left:25px;"><span class="glyphicon glyphicon-envelope"></span> Email</label>
                    <input type="email" class="form-control" id="lp_Email" placeholder="Введите email">
                  </div>
                  <div class="form-group" id="secKeyForm" style="margin-top:-10px; display:none;">
                    <label for="psw1" style="margin-left:25px;"><span class="glyphicon glyphicon-eye-open"></span> Secret key</label>
                    <input type="text" class="form-control" id="lp_sKey" placeholder="Secret key">
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button reset" id="reSend" class="btn btn-danger width-100" style="float:left; display:none;">Повторить</button>
                <button type="submit" id="lPassButton" class="btn btn-success width-200" style="float:right;">Восстановить</button>
              </div>
            </div>

          </div>
        </div>

        <!-- Modal sceenshots -->
        <div class="modal fade" id="screens_Modal" role="dialog">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header" style="padding:0px 0px;background-color:#f2f2f2;text-align:center">
                <button type="button" class="close" data-dismiss="modal">x</button>
                <h4>Описание</h4>
              </div>
              <div class="modal-body" style="padding:0px 0px;">

              </div>
              <div class="modal-footer">
                <button type="button reset" class="btn btn-danger width-100" data-dismiss="modal">Закрыть</button>
              </div>
            </div>
          </div>
        </div>
        <!-- Nav Bar -->
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a href="https://cr0w.pw" class="navbar-brand">
                <img height="42" src="https://cr0w.pw/images/logoCr0w.png" style="margin-top:-12px;"/>
              </a>
            </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li>
                  <a href="https://cr0w.pw"><span class="glyphicon glyphicon-home"></span> Главная</a>
                </li>
                <li>
                  <a href="/apps.cw"><span class="glyphicon glyphicon-th-large"></span> Приложения</a>
                </li>
                <li style="font-size:13px;">
                  <a href="/about.cw"><span class="glyphicon glyphicon-info-sign"></span> О Cr0w</a>
                </li>
              </ul>
              <ul class="nav navbar-nav navbar-right">
                <li id="enterButton">
                  <a href="#" id="logButtonA"><span class="glyphicon glyphicon-log-in"></span> Вход</a>
                </li>
                <li id="registerButton">
                  <a href="#" id="regButtonA"><span class="glyphicon glyphicon-user"></span> Регистрация</a>
                </li>
                <li id="lPButton">
                  <a href="#" id="lPassButtonA"><span class="glyphicon glyphicon-lock"></span> Забыли пароль?</a>
                </li>
                <li id="myCabButton">
                  <a href="/myCabinet.cw" id="cabinetButt"><span class="glyphicon glyphicon-briefcase"></span> Личный кабинет</a>
                </li>
                <li id="exitButton">
                  <a href="#"><span class="glyphicon glyphicon-log-out"></span> Выход</a>
                </li>
              </ul>
            </div>
          </div>
        </div>



        <!-- Body -->
        <div id="headerwrap-app" style="margin-bottom: 50px; overflow: hidden;">

          <div class="container-fluid">
            <div class="row">
              <div id="frame">
                <ul>
                  <li>
                    <div class="row application-box insta-bg">
                      <img class="page-application-icon" src="images/insta-vector.png">
                    </div>
                  </li>
                  <li>
                    <div class="row application-box vk-bg">
                      <img class="page-application-icon" src="images/vk-icon.jpg">
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <!-- <div class="container" id="apps"></div> -->

        </div>

        <!-- Footer text -->
        <div id="footer" class="navbar-fixed-bottom">
          <div class="container">
            <p class="footer-text">
              <a href="https://cr0w.pw">Cr0w</a> & <a href="https://vk.com/onescript">OneScript</a> © 2017
            </p>
          </div>
        </div>
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <!-- SlidesJS Required: Link to jquery.slides.js -->
        <script src="js/slides/jquery.slides.min.js"></script>
        <!-- End SlidesJS Required -->
        <script>
          $(document).ready(function(){

            $("#showHideContent").click(function () {
              if ($("#slideBlock").is(":hidden")) {
                $('#slideBlock').show("slow");
                $('#slide').show("slow");
                $('#showHideContent').attr('style','border-radius: 0px 0px 5px 5px;background-color:#5b8bde;margin-top:-15px;');
                $('#nameScreensButton').text('Скрыть');
              }
              else {
                $('#slideBlock').hide("slow");
                $('#showHideContent').attr('style','border-radius: 5px 5px 5px 5px;background-color:#5b8bde;');
                $('#nameScreensButton').text('Показать скриншоты');
              }
              return false;
            });
          });
        </script>
        <script>
          $(document).ready(function(){
            $("#regButtonA").click(function(){
              $("#reg_Modal").modal();
            });
          });
        </script>
        <script>
          $(document).ready(function(){
            $("#logButtonA").click(function(){
              $("#log_Modal").modal();
            });
          });
        </script>
        <script>
          $(document).ready(function(){
            $("#lPassButtonA").click(function(){
              $("#lPass_Modal").modal();
            });
          });
        </script>
        <script>
     // script for post query

     $("#regButt").click(function(){
       if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test($("#reg_Email").val())) {var validmail = true; }
       else{ var validmail = false;}

       if ($("#reg_Login").val()!=""){ var validLogin = true; }
       else { var validLogin = false; }

       if ($("#reg_Password").val()!=""){  var validPassword= true;}
       else {var validPassword = false; }

       if (validmail==true && validLogin == true && validPassword == true) {
        $.post("index.php",{ ApiName: "RegistrationSite",username : $("#reg_Login").val(), password : $("#reg_Password").val(), email : $("#reg_Email").val()},onAjaxSuccess);
      }
      else { alert("Заполните все поля");}
     //var login = $("#reg_Login").val();

     //alert(login);
   });



     $("#loginBtn").click(function(){
      if ($("#authlogin").val()!="" && $("#authpass").val()!="") {
        $.post("index.php",{ ApiName: "AuthenthicSite",username : $("#authlogin").val() , password : $("#authpass").val()},onAjaxSuccess);
      }
      else{alert("Заполните все поля"); }
    });


     $("#exitButton").click(function(){
     	$.post("index.php",{ApiName: "exitSite"},onAjaxSuccess);
     });


     $("#lPassButton").click(function() {
      if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test($("#lp_Email").val())) {
        $.post("index.php",{ ApiName: "SendSecretKey", Email : $("#lp_Email").val()},onSecretKeySend);
      }
      else {
        alert("Введите корректный Email");
      }
    });
     $("#reSend").click(function() {
      if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test($("#lp_Email").val())) {
        $.post("index.php",{ ApiName: "SendSecretKey", Email : $("#lp_Email").val()},onSecretKeySend);
      }
      else {
        alert("Введите корректный Email");
      }
    });

     //script for popups
     $('a.show_popup').click(function () {
      $('div.'+$(this).attr("rel")).fadeIn(500);
      $("body").append("<div id='overlay'></div>");
      $('#overlay').show().css({'filter' : 'alpha(opacity=80)'});
      return false;
    });
     $('a.close').click(function () {
      $(this).parent().fadeOut(100);
      $('#overlay').remove('#overlay');
      return false;
    });

     $('#RecovPassButton').click(function() {
      alert("лошарище");
    });

     function onSecretKeySend(data) {
      if (data=="OK") {
        $('#lPassButton').unbind('click');
        $('#lPassButton').on('click',function(){
          $.post("index.php",{ ApiName: "ResetPassword",SecretKey: $('#lp_sKey').val()},onChangePass);
        });
        $('#lPassButton').text('Отправить');
        alert("Код отправлен на Email. Ожидайте письмо с кодом в течении 5-10 минут.");
        $('#secKeyForm').attr('style','display:block;');
        $('#reSend').attr('style','display:block;float:left;');
      }
      else {
        $('.lp_sKey').remove();
        $('.timerLP').remove();
        alert(data);
      }
    }

    function onAjaxSuccess(data) {
      if (data=="OK") { location.assign("https://cr0w.pw/");}
      else{alert(data);}
    }

    function onChangePass(data) {
      if (data=="OK") {alert("Ваш новый пароль отправлен на почту.");location.assign("https://cr0w.pw/"); }
      else{alert(data);}
    }

    $('img').on('dragstart', function(event) { event.preventDefault(); });
  </script>
  
  <script src="AppCard.js"></script>
  <script type="text/javascript" src="itemslide.js"></script>
  <script type="text/javascript" src="sliding.js"></script>
</body>
</html>
